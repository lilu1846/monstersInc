
<html>
  <head>
    <style>
      #map {
        width: 600px;
        height: 400px;
        background-color: grey;
      }
    </style>
    <title>My page title</title>
  </head>

  <body>
    Monsters Inc
    <div id="map"></div>
    <form>
      <select id="icon_to_use">
        <option value="images/squid.png">Monster</option>
        <option value="images/planet.png">Space</option>
        <option value="images/pistol.png">Space-gun</option>
        <option value="images/spaceShip.png">Space-ship</option>
        <option value="images/juice.png">Booze</option>
      </select>
    </form>
    <script>
      var map;
      var allMarkers = [];
      var data =
      `59.85326462355382 17.635631561279297 images/spaceShip.png
      59.85707924777907 17.625201711634872 images/squid.png
      59.85356703500592 17.621980497133336 images/squid.png
      59.85633914071567 17.627205084718298 images/juice.png
      59.85579194829295 17.619193169884966 images/juice.png
      59.85480806845177 17.62935045771883 images/pistol.png
      59.85208466730825 17.624395274324343 images/pistol.png
      59.85397411484696 17.618456745694857 images/planet.png`;
      var markers = data.split("\n");
      function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
            zoom: 15,
            center: {lat: 59.85404051472396, lng: 17.6261043548584}
            });

            if(navigator.geolocation) {
              navigator.geolocation.watchPosition(setMyPosition);
            }
            else {
              alert("Geolocation doesn't work in your browser");
            }

        for (var i=0; i < markers.length; i++) {
          var markerData = markers[i].trim();
          markerData = markerData.split(" ");
          var latitude = markerData[0];
          var longitude = markerData[1];
          var emoji = markerData[2];

          var markerPosition = new google.maps.LatLng(latitude, longitude);
          var marker = new google.maps.Marker({
            position: markerPosition,
            map: map,
            icon: emoji
          });
          allMarkers.push(marker);
        }
        map.addListener('click', function(e) {
          var location = e.latLng;
          placeMarker(e.latLng);
        });
      }
      function setMyPosition(position){
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;
        var pos = new google.maps.LatLng(lat, lng);

        var marker = new google.maps.Marker({
          position: pos,
          map: map,
          icon: "images/scientist.png"
        });
      }
      function placeMarker(location){
        var emoji = document.getElementById('icon_to_use').value;
        var marker = new google.maps.Marker({
          position: location,
          map: map,
          icon: emoji
        });
        console.log(location.lat() + " " + location.lng() + " " + emoji);
      }

    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDVbotudicPGjOtRcnSSkuCergrZk8EQvc&callback=initMap">
    </script>

  </body>
</html>
